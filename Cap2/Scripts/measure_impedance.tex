\begin{python}
from openbci_stream.acquisition import OpenBCIConsumer
from openbci_stream.acquisition.cyton_base import CytonConstants as cons
from openbci_stream.utils.filters import GenericButterBand
import numpy as np
import time

def get_rms(v):
    return np.std(v)

def get_z(v):
    rms = get_rms(v)
    z = (1e-6 * rms * np.sqrt(2) / 6e-9) - 2200
    if z < 0:
        return 0
    return z

Z = []
band_2737 = GenericButterBand(27, 37, fs=250)
with OpenBCIConsumer(
    'wifi',
    '192.168.1.113',
    host='192.168.1.1',
    auto_start=False,
    streaming_package_size=250,
    daisy=False,
) as (stream, openbci):
    # with OpenBCIConsumer(host='192.168.1.1') as stream:

    openbci.command(cons.SAMPLE_RATE_250SPS)
    openbci.command(cons.DEFAULT_CHANNELS_SETTINGS)
    openbci.leadoff_impedance(
        range(1, 9),
        pchan=cons.TEST_SIGNAL_NOT_APPLIED,
        nchan=cons.TEST_SIGNAL_APPLIED,
    )
    time.sleep(1)
    openbci.start_stream()

    for i, message in enumerate(stream):
        if message.topic == 'eeg':
            eeg, aux = message.value['data']
            eeg = band_2737(eeg)
            z = get_z(eeg[0])
            Z.append(z)
            print(f'{z/1000:.2f} kOhm')

        if i >= 15:
            break
\end{python}