%======================================================================
\chapter{Python/Brython: Radiant framework}\label{appendix:brython-radiant}

\begin{description}
   \item[Description:]      A Brython Framework for Web Apps development.
   \item[License:]          BSD-2-clause
   \item[Latest version:]   \quot{3.3.8}
   \item[Python:]           \quot{3.8, 3.9, 3.10}
   \item[PyPi:]             \url{https://pypi.org/project/radiant/}
   \item[Repository:]       \url{https://github.com/UN-GCPDS/brython-radiant}
   \item[Documentation:]    \url{https://radiant-framework.readthedocs.io/en/latest/}
\end{description}
\hrulefill

Radiant is a \footcite{Brython}{https://brython.info/} framework for the quick development of web apps with pure Python/Brython syntax so there is no need to care about (if you donâ€™t want) HTML, CSS, or Javascript. Run over \footcite{Tornado}{https://www.tornadoweb.org/} servers and include support to \textit{Websockets}, \textit{Python Scripts} and \textit{MDC}.


%======================================================================
\section{Install}
\begin{python}
pip install -U radiant
\end{python}


%======================================================================
\section{Bare minimum}
\begin{python}
# Radiant modules
from radiant.server import RadiantAPI

# Brython modules
# This modules are faked after `radiant` import
from browser import document, html  

# Main class inheriting RadiantAPI
class BareMinimum(RadiantAPI):

    # Constructor
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)

        #-----------------------------------------------------------
        # Brython code (finally)
        document.select_one('body') <= html.H1('Hello World')
        #
        # ...all your brython code
        #-----------------------------------------------------------

# Run server
if __name__ == '__main__':
    BareMinimum()
\end{python}


%======================================================================
\section{Extra options}
\begin{python}
# Radiant modules
# Import RadiantServer for advanced options
from radiant.server import RadiantAPI, RadiantServer  

from browser import document, html

# Main class inheriting RadiantAPI
class BareMinimum(RadiantAPI):

    def __init__(self, *args, **kwargs):
        """"""
        super().__init__(*args, **kwargs)

        #-----------------------------------------------------------
        # Brython code
        document.select_one('body') <= html.H1('Hello World')
        #
        # ...all your brython code
        #-----------------------------------------------------------

if __name__ == '__main__':
    # Advance options
    RadiantServer('BareMinimum',
                  host='localhost',
                  port=5000,
                  brython_version='3.9.1',
                  debug_level=0,
                  )
\end{python}


%======================================================================
\section{How to works}
This is basically a set of scripts that allows the same file run from \textit{Python} and \textit{Brython}, when is running under \textit{Python} a \textit{Tornado} server is created and configure the local path for serving static files, and a custom \textit{HTML} template is configured in runtime to import the same script, this time under \textit{Brython}, is very simple.


%======================================================================
\section{WebSockets}
This WebSockets are in the Tornado side and NOT in Brython. So, is basically and \footcite{WebSocketHandler}{https://www.tornadoweb.org/en/stable/websocket.html} object like:

\begin{python}
#ws_handler.py

from tornado.websocket import WebSocketHandler

class WSHandler(WebSocketHandler):

    def open(self):
        ...

    def on_close(self):
        ...

    def on_message(self, message):
        ...
\end{python}

That can be included with the \quot{RadiantServer} class in the \quot{websockethandler} argument:
\begin{python}
RadiantServer('MainApp', websockethandler=('ws_handler.py', 'WSHandler'))
\end{python}

This websocket will be serving on \quot{/ws} URL.

%======================================================================
\section{Python scripting}
This feature is to run a real Python environment through methods that return objects. make sure to inherit \quot{PythonHandler}:
\begin{python}
#python_foo.py

from radiant import PythonHandler

class MyClass(PythonHandler):

    def local_python(self):
        return "This file are running from Local Python environment"

    def pitagoras(self, a, b):
        return math.sqrt(a ** 2 + b ** 2)
\end{python}
This handler can be included with the \quot{RadiantServer} class in the \quot{python} argument:
\begin{python}
RadiantServer('MainApp', python=('python_foo.py', 'MyClass'))
\end{python}
A full example of use could be:
\begin{python}
from radiant import RadiantAPI, RadiantServer
from browser import document, html

class MainApp(RadiantAPI):

    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)

        document.select('body')[0] <= html.H1('Hello World')
        document.select('body')[0] <= html.H3(self.MyClass.local_python())

        a, b = 3, 5
        c = self.MyClass.pitagoras(a, b)
        document.select('body')[0] <= html.H3(f"Pitagoras: {a=}, {b=}, {c=:.3f}")

if __name__ == '__main__':
    RadiantServer('MainApp', python=('python_foo.py', 'MyClass'))
\end{python}


%======================================================================
\section{Custom themes}
Material themes from MDC can be configured with \footcite{Color Tool}{https://material.io/resources/color/} application, just select the desired colors, save the file and add it to the \quot{RadiantServer} class in the attribute \quot{theme}.
\begin{python}
RadiantServer('MainApp', theme='custom_theme.xml')
\end{python}
